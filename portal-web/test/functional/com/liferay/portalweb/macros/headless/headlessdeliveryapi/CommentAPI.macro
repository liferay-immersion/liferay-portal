definition {

	macro _createNCommentsInBlogPosting {
		Variables.assertDefined(parameterList = "${blogPostingId},${numberOfCommentsToCreate},${createStrategy}");

		var size = ${numberOfCommentsToCreate} + 1;
		var i = "1";
		var body = '''
			[
		''';

		while (("${i}" != "${size}") && (maxIterations = "100")) {
			var commentBody = '''
				{
					"text": "commentText${i}"
				}
			''';
			var j = ${i} + 1;

			if ("${j}" == "${size}") {
				var body = StringUtil.replace("${body}", "${body}", "${body}${commentBody}]");
			}
			else {
				var commentBody = StringUtil.replace("${commentBody}", "${commentBody}", "${commentBody},");

				var body = StringUtil.replace("${body}", "${body}", "${body}${commentBody}");
			}

			var i = ${i} + 1;
		}

		var portalURL = JSONCompany.getPortalURL();

		var curl = '''
			${portalURL}/o/headless-delivery/v1.0/blog-postings/${blogPostingId}/comments/batch?createStrategy=${createStrategy} \
			-u test@liferay.com:test \
			-H Content-Type: application/json \
            -d ${body}
		''';

		var curl = JSONCurlUtil.post("${curl}");

		return "${curl}";
	}

	macro _curlBlogPostingChildComments {
		Variables.assertDefined(parameterList = "${commentId}");

		var portalURL = JSONCompany.getPortalURL();

		var curl = '''
			${portalURL}/o/headless-delivery/v1.0/comments/${commentId}/comments \
			-u test@liferay.com:test \
			-H Content-Type: application/json
		''';

		return "${curl}";
	}

	macro _curlBlogPostingChildCommentsByExternalReferenceCode {
		Variables.assertDefined(parameterList = "${blogPostingChildCommentERC},${blogPostingCommentERC}");

		var portalURL = JSONCompany.getPortalURL();
		var siteId = JSONGroupAPI._getGroupIdByName(
			groupName = "Guest",
			site = "true");

		var curl = '''
			${portalURL}/o/headless-delivery/v1.0/sites/${siteId}/comments/by-external-reference-code/${blogPostingCommentERC}/comments/by-external-reference-code/${blogPostingChildCommentERC} \
			-u test@liferay.com:test \
			-H accept: application/json
		''';

		return "${curl}";
	}

	macro _curlBlogPostingComments {
		Variables.assertDefined(parameterList = "${blogPostingId}");

		var portalURL = JSONCompany.getPortalURL();

		var curl = '''
			${portalURL}/o/headless-delivery/v1.0/blog-postings/${blogPostingId}/comments \
			-u test@liferay.com:test \
			-H Content-Type: application/json
		''';

		return "${curl}";
	}

	macro _curlBlogPostingCommentsByExternalReferenceCode {
		Variables.assertDefined(parameterList = "${blogPostingERC},${blogPostingCommentERC}");

		var portalURL = JSONCompany.getPortalURL();
		var siteId = JSONGroupAPI._getGroupIdByName(
			groupName = "Guest",
			site = "true");

		var curl = '''
			${portalURL}/o/headless-delivery/v1.0/sites/${siteId}/blog-postings/by-external-reference-code/${blogPostingERC}/comments/by-external-reference-code/${blogPostingCommentERC} \
			-u test@liferay.com:test \
			-H accept: application/json
		''';

		return "${curl}";
	}

	macro createCommentInBlogPosting {
		Variables.assertDefined(parameterList = "${commentText}");

		if (!(isSet(externalReferenceCode))) {
			var externalReferenceCode = "";
		}

		if (!(isSet(parentCommentId))) {
			var parentCommentId = "0";
		}

		if (isSet(blogPostingId) && !(isSet(commentId))) {
			var curl = CommentAPI._curlBlogPostingComments(blogPostingId = "${blogPostingId}");
		}

		if (isSet(commentId) && !(isSet(blogPostingId))) {
			var curl = CommentAPI._curlBlogPostingChildComments(commentId = "${commentId}");
		}

		var body = '''
			-d {
				"externalReferenceCode": "${externalReferenceCode}",
				"parentCommentId": "${parentCommentId}",
				"text": "${commentText}"
			}
		''';

		var curl = StringUtil.add("${curl}", "${body}", " ");

		var response = JSONCurlUtil.post("${curl}");

		return "${response}";
	}

	macro getFieldValueOfBlogPostingComments {
		Variables.assertDefined(parameterList = "${fieldName}");

		if (isSet(blogPostingId) && !(isSet(commentId))) {
			var curl = CommentAPI._curlBlogPostingComments(blogPostingId = "${blogPostingId}");

			var response = JSONCurlUtil.get("${curl}");
		}

		if (isSet(commentId) && !(isSet(blogPostingId))) {
			var curl = CommentAPI._curlBlogPostingChildComments(commentId = "${commentId}");

			var response = JSONCurlUtil.get("${curl}");
		}

		if (isSet(blogPostingERC) && isSet(blogPostingCommentERC)) {
			var curl = CommentAPI._curlBlogPostingCommentsByExternalReferenceCode(
				blogPostingCommentERC = "${blogPostingCommentERC}",
				blogPostingERC = "${blogPostingERC}");

			var response = JSONCurlUtil.get("${curl}");
		}

		if (isSet(blogPostingChildCommentERC) && isSet(blogPostingCommentERC)) {
			var curl = CommentAPI._curlBlogPostingChildCommentsByExternalReferenceCode(
				blogPostingChildCommentERC = "${blogPostingChildCommentERC}",
				blogPostingCommentERC = "${blogPostingCommentERC}");

			var response = JSONCurlUtil.get("${curl}");
		}

		var fieldValue = JSONUtil.getWithJSONPath("${response}", "$..${fieldName}");

		return "${fieldValue}";
	}

	macro getIdOfCreateNCommentsInBlogPostingBatchEngineImportTask {
		var response = CommentAPI._createNCommentsInBlogPosting(
			blogPostingId = "${blogPostingId}",
			createStrategy = "${createStrategy}",
			numberOfCommentsToCreate = "${numberOfCommentsToCreate}");

		var importTaskId = JSONUtil.getWithJSONPath("${response}", "$.id");

		return "${importTaskId}";
	}

}